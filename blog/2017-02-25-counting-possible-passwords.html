<html>
<head>
  <meta charset="UTF-8">
  <title>
    Counting Possible Passwords — Sorawee's Website
  </title>
  <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/fira.css">
  <link href="https://afeld.github.io/emoji-css/emoji.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" media="all" href="../css/styles.css" />
  <link rel="stylesheet" type="text/css" media="all" href="../css/normalize.css" />
  <link rel="stylesheet" type="text/css" media="all" href="../css/styles-github.css" />
  <script type="text/javascript"
    src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS_CHTML">
  </script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$']]},
      TeX: {
        Macros: {
          seq: ["{\\langle #1 \\rangle}", 1],
          set: ["{\\{ #1 \\}}", 1],
          setof: ["{\\{ #1 \\ | \\ #2 \\}}", 2],
          N: "{\\mathbb N}",
          R: "{\\mathbb R}",
          Z: "{\\mathbb Z}",
          Q: "{\\mathbb Q}",
          floor: ["{\\lfloor #1 \\rfloor}", 1],
          ceil: ["{\\lceil #1 \\rceil}", 1],
        }
      }
    });
  </script>
  <style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
</head>
<body>
  <nav><ul>
    <li><a href="../blog/2017-10-05-deriving-Y.html">&larr; Previous</a></li>
    <li><a href="../">&uarr; Home</a></li>
    <li><a href="../blog/2017-02-01-on-induction.html">Next &rarr;</a></li>
    <li>
      <a href="2017-02-25-counting-possible-passwords.pdf">
        <img src="../css/pdficon.png" width="15" height="15" alt="Download PDF" />
        <span class="caps" style="font-style: normal">PDF</span>
      </a>
    </li>
    <li style="width: auto;">
      <a href="https://github.com/sorawee/my-website/blob/master/blog/2017-02-25-counting-possible-passwords.poly.pm" title="View the Pollen source for this file"
         class="sourcelink code">&loz; Pollen Source
      </a>
    </li>
  </ul></nav>
  <section class="page-header">
    <h1 class="project-name">
      <a href="../">Sorawee's Website</a>
    </h1>
    <h2 class="project-tagline"></h2>
    <a href="../" class="btn">Blog</a>
    <a href="../books.html" class="btn">Books</a>
    <a href="../feed.xml" class="btn">RSS</a>
    <a href="../about.html" class="btn">About Me</a>
  </section>
  <section class="main-content" id="the-main">
    <div id="real-content">
      <h1>Counting Possible Passwords</h1><p class="tags">Tags: <a href="/tags/dynamic-programming">dynamic-programming</a>, <a href="/tags/programming">programming</a></p><p class="pubdate">Published on Saturday, February 25th, 2017</p><div class="content"><p>Jack showed <a href="http://portal.cs.oag.state.tx.us/OAGStaticContent/portal/login/help/listPasswordRules.htm">“the rules for password naming”</a> in a website to me. Here’s an excerpt:</p><blockquote><ol><li>The password must be exactly 8 characters long.</li><li>It must contain at least one letter, one number, and one of the following special characters.</li><li>The only special characters allowed are: @ # $</li><li>A special chaacter must not be located in the first or last position.</li><li>Two of the same characters sitting next to each other are considered to be a “set.” No “sets” are allowed. Example: rr, tt</li><li>Avoid using names, such as your name, user ID, or the name of your company or employer.</li><li>Other words that cannot be used are Texas, child, and the months of the year.</li><li><p>A new password cannot be too similar to the previous password.</p><ul><li>Example: previous password - abc#1234; unacceptable new password - acb$1243</li><li>Characters in the first, second, and third positions cannot be identical. (abc*****)</li><li>Characters in the second, third, and fourth positions cannot be identical. (*bc#****)</li><li>Characters in the sixth, seventh, and eighth positions cannot be identical. (*****234)</li></ul></li><li>A password can be changed voluntarily (no Help Desk assistance needed) once in a 15-day period. If needed, the Help Desk can reset the password at any time.</li><li>The previous 8 passwords cannot be reused.</li></ol><p>One way to create a password is creative spelling and substitution. Examples:</p><ol><li>phuny#2s</li><li>fish#1ng</li><li>t0pph@ts<label for="c1e7f23f-d3b8-428a-83f1-ff2a3f38e427" class="margin-toggle sidenote-number"></label><input type="checkbox" id="c1e7f23f-d3b8-428a-83f1-ff2a3f38e427" class="margin-toggle"/><span class="sidenote">Ahem... To quote from somewhere... No “sets” are allowed.</span></li><li>run$4you</li><li>ba#3ries</li></ol></blockquote><p>I’m terrified.</p><p><see-more></see-more></p><p>This reminds me of an xkcd comic <a href="https://xkcd.com/936/">“Password Strength”</a>. As the comic states, through 20 years of effort, we’ve successfully trained everyone to use passwords that are hard for humans to remember, but easy for computers to guess. For this website, it’s even worse because the website itself forces users to abide these nonsensical rules.</p><p>What we are more interested, however, is to count how many possible passwords there are! We will consider only rule 1 to 5, as the rest is about specific names or previous passwords which would be hard to define mathematically.</p><p>It might be possible to use combinatorics to solve the problem. However, as I study computer science, I will use computer to solve the problem!</p><p>First, write a naive program to count the answer:</p><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="source"><pre class="other"><span></span><span class="kn">import</span> <span class="nn">string</span> <span class="kn">as</span> <span class="nn">st</span>

<span class="k">def</span> <span class="nf">count_naive</span><span class="p">(</span><span class="n">num_symbols</span><span class="p">,</span> <span class="n">num_digits</span><span class="p">,</span> <span class="n">num_letters</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
    <span class="n">symbol_chars</span> <span class="o">=</span> <span class="s2">"@#$!%^&amp;*()_+=-`~{}[]:?/&gt;.&lt;,;"</span><span class="p">[:</span><span class="n">num_symbols</span><span class="p">]</span>
    <span class="n">digit_chars</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">digits</span><span class="p">[:</span><span class="n">num_digits</span><span class="p">]</span>
    <span class="n">letter_chars</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">[:</span><span class="n">num_letters</span><span class="p">]</span>
    <span class="n">all_chars</span> <span class="o">=</span> <span class="n">symbol_chars</span> <span class="o">+</span> <span class="n">digit_chars</span> <span class="o">+</span> <span class="n">letter_chars</span>
    <span class="n">string</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">passed</span> <span class="o">=</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">c</span> <span class="ow">in</span> <span class="n">string</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">symbol_chars</span><span class="p">)</span> <span class="ow">and</span>
                      <span class="nb">any</span><span class="p">(</span><span class="n">c</span> <span class="ow">in</span> <span class="n">string</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">digit_chars</span><span class="p">)</span> <span class="ow">and</span>
                      <span class="nb">any</span><span class="p">(</span><span class="n">c</span> <span class="ow">in</span> <span class="n">string</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">letter_chars</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">passed</span><span class="p">:</span>
                <span class="c1"># uncomment next line to print all passwords</span>
                <span class="c1"># print(&#39;&#39;.join(string[1:]))</span>
                <span class="k">pass</span>
            <span class="k">return</span> <span class="n">passed</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_chars</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="n">length</span><span class="p">)</span> <span class="ow">and</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">symbol_chars</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="n">string</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">generate</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">string</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">total</span>
    <span class="k">return</span> <span class="n">generate</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
</pre></div></td></tr></tbody></table></div><p>And then we can run:</p><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="source"><pre class="other"><span></span>$ python3 -i count.py
&gt;&gt;&gt; count_naive<span class="o">(</span><span class="m">2</span>, <span class="m">3</span>, <span class="m">4</span>, <span class="m">5</span><span class="o">)</span> <span class="c1"># 2 symbols, 3 numbers, 4 letters, length 5</span>
<span class="m">11472</span>
</pre></div></td></tr></tbody></table></div><p>Pretty much, this program goes over the entire possible strings<label for="a9f03acd-3f18-4123-9499-02ac1206ded4" class="margin-toggle sidenote-number"></label><input type="checkbox" id="a9f03acd-3f18-4123-9499-02ac1206ded4" class="margin-toggle"/><span class="sidenote">All <code>continue</code> statements would do some pruning, but that won’t help much</span> and chooses only valid ones. Now, we can compute the answer to the original question. It’s just <code>count_naive(3, 10, 52, 8)</code>, as the number of symbols is 3 (#, $, and @); the number of digits, 10 (0-9); number of letters, 52 (a-z, A-Z), right?</p><p>The answer is yes, but as the program goes over the entire possible strings, it would take a really long time to compute an answer. In particular, the algorithm’s runtime is <mathjax>$O(s + d + l)^n$</mathjax> where <mathjax>$s$</mathjax> is number of symbols, <mathjax>$d$</mathjax> is number of digits, <mathjax>$l$</mathjax> is number of letters, and <mathjax>$n$</mathjax> is the length. With this, we can approximate the real runtime. The number of all possible strings is <mathjax>$(3 + 10 + 52)^8 = 318644812890625$</mathjax>. Assuming that our computer can execute 1 billion instructions per second, it would take <mathjax>$(3 + 10 + 52)^8 (\frac{1}{1000000000})(\frac{1}{60})(\frac{1}{60})(\frac{1}{24}) \approx 3.68$</mathjax> days to count them all. I don’t want to wait that long!</p><p>To reduce the running time, notice that all numbers/letters/symbols look the same. Instead of iterating over <mathjax>$(3 + 10 + 52)^8$</mathjax> states, we can compact these states, iterating over only <mathjax>$(1 + 1 + 1)^8 = 6561$</mathjax> states!</p><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="source"><pre class="other"><span></span><span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="n">num_symbols</span><span class="p">,</span> <span class="n">num_digits</span><span class="p">,</span> <span class="n">num_letters</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
    <span class="n">SYMBOL</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">DIGIT</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">LETTER</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">num_symbols</span><span class="p">,</span> <span class="n">num_digits</span><span class="p">,</span> <span class="n">num_letters</span><span class="p">]</span>
    <span class="n">string</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">nonlocal</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">total</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">}</span> <span class="o">&lt;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
                <span class="n">total</span> <span class="o">+=</span> <span class="n">cnt</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="n">length</span><span class="p">)</span> <span class="ow">and</span> <span class="n">g</span> <span class="o">==</span> <span class="n">SYMBOL</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">mult</span> <span class="o">=</span> <span class="n">sizes</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">string</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">g</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mult</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">string</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">cnt</span> <span class="o">*=</span> <span class="n">mult</span>
            <span class="n">generate</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">cnt</span> <span class="o">//=</span> <span class="n">mult</span>
            <span class="n">string</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">generate</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total</span>
</pre></div></td></tr></tbody></table></div><p>The above algorithm has runtime <mathjax>$O(3^n)$</mathjax>! The tricky part is excluding string which has the same characters adjacent to each other. To do this, we notice that if the group (type of the character–letter, digit, or symbol) matches the previous group, then instead of having all choices, we would lose one because it’s the same as the previous character.<label for="ebfb097a-cd11-4977-80dd-263c058c699e" class="margin-toggle sidenote-number"></label><input type="checkbox" id="ebfb097a-cd11-4977-80dd-263c058c699e" class="margin-toggle"/><span class="sidenote">This, by the way, is the first time I use Python 3’s <code>nonlocal</code>.</span></p><p>Computing the answer is now feasible (only one second!).</p><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="source"><pre class="other"><span></span>$ python3 -i count.py
&gt;&gt;&gt; count<span class="o">(</span><span class="m">2</span>, <span class="m">3</span>, <span class="m">4</span>, <span class="m">5</span><span class="o">)</span>
<span class="m">11472</span> <span class="c1"># great! this matches our previous implementation</span>
&gt;&gt;&gt; count<span class="o">(</span><span class="m">3</span>, <span class="m">10</span>, <span class="m">52</span>, <span class="m">8</span><span class="o">)</span>
<span class="m">46082343914880</span>
</pre></div></td></tr></tbody></table></div><p>Assuming that this answer is correct, we can see that all these weird rules reduce <mathjax>$(3 + 10 + 52)^8 - 46082343914880 = 272562468975745$</mathjax> possible passwords!</p><p>How can we be sure that this new program is indeed correct? We can create an oracle to test it on smaller inputs, using the slower but definitely correct algorithm as the tester.</p><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="source"><pre class="other"><span></span><span class="k">def</span> <span class="nf">oracle</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">):</span>
    <span class="n">lim</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Trial #{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">trial</span><span class="p">))</span>
        <span class="n">num_symbols</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lim</span><span class="p">)</span>
        <span class="n">num_digits</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lim</span><span class="p">)</span>
        <span class="n">num_letters</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lim</span><span class="p">)</span>
        <span class="n">length</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lim</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">num_symbols</span><span class="p">,</span> <span class="n">num_digits</span><span class="p">,</span> <span class="n">num_letters</span><span class="p">,</span> <span class="n">length</span><span class="p">]</span>
        <span class="n">answer1</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">answer2</span> <span class="o">=</span> <span class="n">f2</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">answer1</span> <span class="o">!=</span> <span class="n">answer2</span><span class="p">:</span>
            <span class="k">print</span><span class="p">((</span><span class="s2">"symbols: {}, digits: {}, letters: {}, len: {}</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span>
                   <span class="s2">"f1: {}, f2: {}"</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">args</span> <span class="o">+</span> <span class="p">[</span><span class="n">answer1</span><span class="p">,</span> <span class="n">answer2</span><span class="p">])))</span>
            <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>

<span class="k">print</span><span class="p">(</span><span class="n">oracle</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">count_naive</span><span class="p">))</span> <span class="c1">#=&gt; True</span>
</pre></div></td></tr></tbody></table></div><p>Now we have an <mathjax>$O(3^n)$</mathjax> algorithm. Can we do better? The answer is yes! We will use dynamic programming to help improving the runtime to linear!!</p><p>Let <mathjax>$T[n, g, s, d, l]$</mathjax> indicates the number of possible words with length <mathjax>$n$</mathjax>, ending with a character in group <mathjax>$g \in \set{0, 1, 2}$</mathjax>, containing at least one symbol iff <mathjax>$s = 1$</mathjax>, containing at least one digit iff <mathjax>$d = 1$</mathjax>, and containing at least one letter iff <mathjax>$l = 1$</mathjax>, where <mathjax>$s, d, l \in \set{0, 1}$</mathjax>. The recurrence equation now becomes apparent.<label for="7671463f-684f-4855-8e8e-599b18a2e2f4" class="margin-toggle sidenote-number"></label><input type="checkbox" id="7671463f-684f-4855-8e8e-599b18a2e2f4" class="margin-toggle"/><span class="sidenote">I’m just too lazy to explain, but it’s not hard to see. If I were to write a textbook, this would be a good opportunity to write the infamous “left as an exercise”</span></p><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="source"><pre class="other"><span></span><span class="k">def</span> <span class="nf">count_dp</span><span class="p">(</span><span class="n">num_symbols</span><span class="p">,</span> <span class="n">num_digits</span><span class="p">,</span> <span class="n">num_letters</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
    <span class="n">SYMBOL</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">DIGIT</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">LETTER</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">num_symbols</span><span class="p">,</span> <span class="n">num_digits</span><span class="p">,</span> <span class="n">num_letters</span><span class="p">]</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">binary</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">dp_template</span> <span class="o">=</span> <span class="p">{(</span><span class="n">g</span><span class="p">,</span> <span class="n">hs</span><span class="p">,</span> <span class="n">hd</span><span class="p">,</span> <span class="n">hl</span><span class="p">):</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span>
                                      <span class="k">for</span> <span class="n">hs</span> <span class="ow">in</span> <span class="n">binary</span>
                                      <span class="k">for</span> <span class="n">hd</span> <span class="ow">in</span> <span class="n">binary</span>
                                      <span class="k">for</span> <span class="n">hl</span> <span class="ow">in</span> <span class="n">binary</span><span class="p">}</span>
    <span class="n">dp_new</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dp_template</span><span class="p">)</span>
    <span class="n">dp_new</span><span class="p">[</span><span class="n">SYMBOL</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># the first character can&#39;t be a symbol</span>
    <span class="n">dp_new</span><span class="p">[</span><span class="n">DIGIT</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sizes</span><span class="p">[</span><span class="n">DIGIT</span><span class="p">]</span>
    <span class="n">dp_new</span><span class="p">[</span><span class="n">LETTER</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sizes</span><span class="p">[</span><span class="n">LETTER</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="n">dp_old</span> <span class="o">=</span> <span class="n">dp_new</span>
        <span class="n">dp_new</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dp_template</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="n">space</span> <span class="o">=</span> <span class="p">[(</span><span class="n">hs</span><span class="p">,</span> <span class="n">hd</span><span class="p">,</span> <span class="n">hl</span><span class="p">)</span> <span class="k">for</span> <span class="n">hs</span> <span class="ow">in</span> <span class="n">binary</span>
                                  <span class="k">for</span> <span class="n">hd</span> <span class="ow">in</span> <span class="n">binary</span>
                                  <span class="k">for</span> <span class="n">hl</span> <span class="ow">in</span> <span class="n">binary</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">hs</span><span class="p">,</span> <span class="n">hd</span><span class="p">,</span> <span class="n">hl</span> <span class="ow">in</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">space</span> <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">prevg</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
                    <span class="n">dp_new</span><span class="p">[</span><span class="n">g</span><span class="p">,</span><span class="n">hs</span><span class="p">,</span><span class="n">hd</span><span class="p">,</span><span class="n">hl</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
                        <span class="n">dp_old</span><span class="p">[</span><span class="n">prevg</span><span class="p">,</span> <span class="n">hs</span><span class="p">,</span> <span class="n">hd</span><span class="p">,</span> <span class="n">hl</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">(</span><span class="n">dp_old</span><span class="p">[</span><span class="n">prevg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hd</span><span class="p">,</span> <span class="n">hl</span><span class="p">]</span> <span class="k">if</span> <span class="n">g</span> <span class="o">==</span> <span class="n">SYMBOL</span> <span class="ow">and</span> <span class="n">hs</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span>
                        <span class="p">(</span><span class="n">dp_old</span><span class="p">[</span><span class="n">prevg</span><span class="p">,</span> <span class="n">hs</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hl</span><span class="p">]</span> <span class="k">if</span> <span class="n">g</span> <span class="o">==</span> <span class="n">DIGIT</span> <span class="ow">and</span> <span class="n">hd</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span>
                        <span class="p">(</span><span class="n">dp_old</span><span class="p">[</span><span class="n">prevg</span><span class="p">,</span> <span class="n">hs</span><span class="p">,</span> <span class="n">hd</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">g</span> <span class="o">==</span> <span class="n">LETTER</span> <span class="ow">and</span> <span class="n">hl</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">sizes</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">g</span> <span class="o">==</span> <span class="n">prevg</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">dp_new</span><span class="p">[</span><span class="n">DIGIT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dp_new</span><span class="p">[</span><span class="n">LETTER</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="n">oracle</span><span class="p">(</span><span class="n">count_dp</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span> <span class="c1">#=&gt; True</span>
</pre></div></td></tr></tbody></table></div><p>This yields a linear time algorithm. Additionally, the algorithm takes constant amount of memory!</p><p>FIN <i class="em em-smiley"></i></p></div><hr/>
    </div>
    <div id="disqus_thread"></div>
    <script>
    var disqus_config = function () {
    this.page.identifier = "blog/2017-02-25-counting-possible-passwords.html"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//sorawee.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </section>
</body>
</html>