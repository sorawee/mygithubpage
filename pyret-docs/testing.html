<!doctype HTML>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="codemirror.js"></script>
<script src="runmode.js"></script>
<script src="pyret.js"></script>
<script src="hilite.js"></script>
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>2.2&nbsp;Testing</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="styles.css" title="default"/><link rel="stylesheet" type="text/css" href="codemirror.css" title="default"/><link rel="stylesheet" type="text/css" href="editor.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Pyret</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Getting_Started.html" class="tocviewlink" data-pltdoc="x">Getting Started</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Language_Concepts.html" class="tocviewselflink" data-pltdoc="x">Language Concepts</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Builtins.html" class="tocviewlink" data-pltdoc="x">Builtins</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Libraries.html" class="tocviewlink" data-pltdoc="x">Libraries</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="Internals.html" class="tocviewlink" data-pltdoc="x">Internals</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td>2&nbsp;</td><td><a href="Language_Concepts.html" class="tocviewlink" data-pltdoc="x">Language Concepts</a></td></tr></table><div class="tocviewsublist" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">2.1&nbsp;</td><td><a href="s_forms.html" class="tocviewlink" data-pltdoc="x">Language Constructs</a></td></tr><tr><td align="right">2.2&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Testing</a></td></tr><tr><td align="right">2.3&nbsp;</td><td><a href="equality.html" class="tocviewlink" data-pltdoc="x">equality</a></td></tr><tr><td align="right">2.4&nbsp;</td><td><a href="brands.html" class="tocviewlink" data-pltdoc="x">Brands</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">&#9658;</a></td><td>2.2&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Testing</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tr><td align="right">2.2.1&nbsp;</td><td><a href="#%28part._testing-blocks%29" class="tocviewlink" data-pltdoc="x"><span class="pyret-highlight"><span class="stt">check:</span></span> and <span class="pyret-highlight"><span class="stt">where:</span></span> blocks</a></td></tr><tr><td align="right">2.2.2&nbsp;</td><td><a href="#%28part._testing-operators%29" class="tocviewlink" data-pltdoc="x">Testing Operators</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">2.2.1<tt>&nbsp;</tt></span><a href="#%28part._testing-blocks%29" class="tocsubseclink" data-pltdoc="x"><span class="pyret-highlight"><span class="stt">check:</span></span> and <span class="pyret-highlight"><span class="stt">where:</span></span> blocks</a></td></tr><tr><td><span class="tocsublinknumber">2.2.1.1<tt>&nbsp;</tt></span><a href="#%28part._check__blocks%29" class="tocsubseclink" data-pltdoc="x"><span class="pyret-highlight"><span class="stt">check:</span></span> blocks</a></td></tr><tr><td><span class="tocsublinknumber">2.2.1.2<tt>&nbsp;</tt></span><a href="#%28part._where__blocks%29" class="tocsubseclink" data-pltdoc="x"><span class="pyret-highlight"><span class="stt">where:</span></span> blocks</a></td></tr><tr><td><span class="tocsublinknumber">2.2.2<tt>&nbsp;</tt></span><a href="#%28part._testing-operators%29" class="tocsubseclink" data-pltdoc="x">Testing Operators</a></td></tr><tr><td><span class="tocsublinknumber">2.2.2.1<tt>&nbsp;</tt></span><a href="#%28part._.Binary_.Test_.Operators%29" class="tocsubseclink" data-pltdoc="x">Binary Test Operators</a></td></tr><tr><td><a href="#%28part._testing_is%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">is</span></a></td></tr><tr><td><a href="#%28part._testing_is-not%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">is-<wbr></wbr>not</span></a></td></tr><tr><td><a href="#%28part._testing_is~25%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">is%</span></a></td></tr><tr><td><a href="#%28part._testing_is-not~25%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">is-<wbr></wbr>not%</span></a></td></tr><tr><td><a href="#%28part._testing_is~3d~3d%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">is==</span></a></td></tr><tr><td><a href="#%28part._testing_is-not~3d~3d%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">is-<wbr></wbr>not==</span></a></td></tr><tr><td><a href="#%28part._testing_is~3d~7e%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">is=~</span></a></td></tr><tr><td><a href="#%28part._testing_is-not~3d~7e%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">is-<wbr></wbr>not=~</span></a></td></tr><tr><td><a href="#%28part._testing_is~3c~3d~3e%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">is&lt;=&gt;</span></a></td></tr><tr><td><a href="#%28part._testing_is-not~3c~3d~3e%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">is-<wbr></wbr>not&lt;=&gt;</span></a></td></tr><tr><td><span class="tocsublinknumber">2.2.2.2<tt>&nbsp;</tt></span><a href="#%28part._.Unary_.Test_.Operators%29" class="tocsubseclink" data-pltdoc="x">Unary Test Operators</a></td></tr><tr><td><a href="#%28part._testing_satisfies%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">satisfies</span></a></td></tr><tr><td><a href="#%28part._testing_violates%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">violates</span></a></td></tr><tr><td><span class="tocsublinknumber">2.2.2.3<tt>&nbsp;</tt></span><a href="#%28part._.Exception_.Test_.Operators%29" class="tocsubseclink" data-pltdoc="x">Exception Test Operators</a></td></tr><tr><td><a href="#%28part._testing_raises%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">raises</span></a></td></tr><tr><td><a href="#%28part._testing_raises-other-than%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">raises-<wbr></wbr>other-<wbr></wbr>than</span></a></td></tr><tr><td><a href="#%28part._testing_does-not-raise%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">does-<wbr></wbr>not-<wbr></wbr>raise</span></a></td></tr><tr><td><a href="#%28part._testing_raises-satisfies%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">raises-<wbr></wbr>satisfies</span></a></td></tr><tr><td><a href="#%28part._testing_raises-violates%29" class="tocsubnonseclink" data-pltdoc="x"><span class="stt">raises-<wbr></wbr>violates</span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="s_annotations.html" title="backward to &quot;2.1.7 Annotations&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Language_Concepts.html" title="up to &quot;2 Language Concepts&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="equality.html" title="forward to &quot;2.3 equality&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h4>2.2<tt>&nbsp;</tt><a name="(part._testing)"></a>Testing</h4><h5>2.2.1<tt>&nbsp;</tt><a name="(part._testing-blocks)"></a><span class="pyret-highlight"><span class="stt">check:</span></span> and <span class="pyret-highlight"><span class="stt">where:</span></span> blocks</h5><p>Tests in Pyret are written in special <span style="font-style: italic">testing blocks</span>.  These blocks can
contain any Pyret code that isn&rsquo;t toplevel-only (like data definitions and
import or provide statements), and are the only places where
<a href="#%28part._testing-operators%29" data-pltdoc="x">Testing Operators</a> can be used.</p><h5>2.2.1.1<tt>&nbsp;</tt><a name="(part._check__blocks)"></a><span class="pyret-highlight"><span class="stt">check:</span></span> blocks</h5><p>The simplest testing blocks are <span class="pyret-highlight"><span class="stt">check:</span></span> blocks.  They can be written at
the top-level or inside other testing blocks.  Check blocks are a unit of
reporting test results, so all the test operators that evaluate inside a check
block will be reported as part of that block.  For example, these two check
blocks:</p><pre class="pyret-highlight"><p>check "a first block":
  5 is 5
  4 is 5
end

check "a second block":
  6 is 7
end</p></pre><p>will report:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Check block: a first block</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">test (5 is 5): ok</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">test (4 is 5): failed, reason:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">Values not equal:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">4</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">5</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">1/2 tests passed in check block: a first block</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">Check block: a second block</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">test (6 is 7): failed, reason:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">Values not equal:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">6</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">7</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">The test failed.</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">1/3 tests passed in all check blocks</span></p></td></tr></table></p><p>Testing blocks are also a unit of failure: most of the time an error stops the
whole program, but inside a check block (and also inside <a href="#%28part._testing_raises%29" data-pltdoc="x"><span class="stt">raises</span></a>,
mentioned later), the error is stopped and reported, and Pyret goes on to
evaluating the next check block:</p><pre class="pyret-highlight"><p>check "error-block":
  raise("an error here doesn't stop the next check block from running")
  string-length("this test doesn't run") is 21
end

check "a later block":
  string-length("these tests still run") is 21
end</p></pre><p>Keep an eye out for the message <span class="pyret-highlight"><span class="stt">"Check block &lt;some-block&gt; ended in an error (all tests may not have run):"</span></span>,
because it means that later tests in the
same block may not have run, so the output doesn&rsquo;t reflect all the tests that
were written.</p><h5>2.2.1.2<tt>&nbsp;</tt><a name="(part._where__blocks)"></a><span class="pyret-highlight"><span class="stt">where:</span></span> blocks</h5><p>Sometimes a function has tests that are explicitly associated with it.  For
these cases, the function can end in a <span class="pyret-highlight"><span class="stt">where:</span></span> block rather than
immediately with <span class="pyret-highlight"><span class="stt">end</span></span>.  <span class="pyret-highlight"><span class="stt">where:</span></span> blocks run the same way that
<span class="pyret-highlight"><span class="stt">check:</span></span> blocks do, and their name is taken from the function they are
attached to.</p><div class="examples"><p><div class="SIntrapara"><span style="font-weight: bold">Examples:</span></div><div class="SIntrapara"><pre class="pyret-highlight"><p>fun double(n):
  n + n
where:
  double(10) is 20
  double(15) is 30
end</p></pre></div></p></div><h5>2.2.2<tt>&nbsp;</tt><a name="(part._testing-operators)"></a>Testing Operators</h5><p>Testing operators should be written on their own line inside a <span class="pyret-highlight"><span class="stt">check:</span></span> or
<span class="pyret-highlight"><span class="stt">where:</span></span> block.  They can check for a number of properties and come in
several forms.</p><h5>2.2.2.1<tt>&nbsp;</tt><a name="(part._.Binary_.Test_.Operators)"></a>Binary Test Operators</h5><p>Many useful tests compare two values, whether for a specific type of
<a href="equality.html" data-pltdoc="x">equality</a> or a more sophisticated predicate.</p><p class="boxed pyret-header"><span class="stt">expr1</span><span class="stt"> </span><a name="(part._testing_is)" class="pyret-code"></a><a href="#%28part._testing_is%29" data-pltdoc="x"><span class="stt">is</span></a><span class="stt"> </span><span class="stt">expr2</span></p><p>Evaluates <span class="pyret-highlight"><span class="stt">expr1</span></span> and <span class="pyret-highlight"><span class="stt">expr2</span></span> to values, and checks if two values
are equal via <a href="equality.html#%28part._equality_equal-always%29" data-pltdoc="x"><span class="stt">equal-always</span></a>, reporting success if they
are equal, and failure if they are not.</p><p class="boxed pyret-header"><span class="stt">expr1</span><span class="stt"> </span><a name="(part._testing_is-not)" class="pyret-code"></a><a href="#%28part._testing_is-not%29" data-pltdoc="x"><span class="stt">is-not</span></a><span class="stt"> </span><span class="stt">expr2</span></p><p>Like <a href="#%28part._testing_is%29" data-pltdoc="x"><span class="stt">is</span></a>, but failure and success are reversed.</p><p class="boxed pyret-header"><span class="stt">expr1</span><span class="stt"> </span><a name="(part._testing_is~25)" class="pyret-code"></a><a href="#%28part._testing_is~25%29" data-pltdoc="x"><span class="stt">is%</span></a><span class="stt">(</span><span class="stt">pred</span><span class="stt">)</span><span class="stt"> </span><span class="stt">expr2</span></p><p>Evaluates <span class="pyret-highlight"><span class="stt">expr1</span></span> and <span class="pyret-highlight"><span class="stt">expr2</span></span> to values, and <span class="pyret-highlight"><span class="stt">pred</span></span> to a
value that must be a function (an error is reported if <span class="pyret-highlight"><span class="stt">pred</span></span> is not a
function).  It then applies <span class="pyret-highlight"><span class="stt">pred</span></span> to the two values from <span class="pyret-highlight"><span class="stt">expr1</span></span>
and <span class="pyret-highlight"><span class="stt">expr2</span></span>.  If the result of that call is <span class="pyret-highlight"><span class="stt">true</span></span>, reports
success, otherwise reports failure.</p><p class="boxed pyret-header"><span class="stt">expr1</span><span class="stt"> </span><a name="(part._testing_is-not~25)" class="pyret-code"></a><a href="#%28part._testing_is-not~25%29" data-pltdoc="x"><span class="stt">is-not%</span></a><span class="stt">(</span><span class="stt">pred</span><span class="stt">)</span><span class="stt"> </span><span class="stt">expr2</span></p><p>Like <a href="#%28part._testing_is~25%29" data-pltdoc="x"><span class="stt">is%</span></a>, but failure and success are reversed.</p><div class="examples"><p><div class="SIntrapara"><span style="font-weight: bold">Examples:</span></div><div class="SIntrapara"><pre class="pyret-highlight"><p>check:
  fun less-than(n1, n2): n1 &lt; n2 end

  1 is%(less-than) 2
  2 is-not%(less-than) 1
end

check:
  fun longer-than(s1, s2):
    string-length(s1) &gt; string-length(s2)
  end

  "abc" is%(longer-than) "ab"
  "" is-not%(longer-than) ""
end

check:
  fun&lt;a&gt; equal-any-order(l1 :: List&lt;a&gt;, l2 :: List&lt;a&gt;):
    same-length = (l1.length() == l2.length())
    all-present = for lists.all(elt from l1):
      lists.member(l2, elt)
    end
    same-length and all-present
  end

  [list: 1, 2, 3] is%(equal-any-order) [list: 3, 2, 1]
  [list: 1, 2, 3] is%(equal-any-order) [list: 2, 1, 3]
  [list: 1, 2, 3, 3] is-not%(equal-any-order) [list: 2, 1, 3]
end

check:
  fun one-of(ans, elts):
    lists.member(elts, ans)
  end

  some-strings = [list: "123", "132", "213", "231", "312", "321"]
  "321" is%(one-of) some-strings
  "123" is%(one-of) some-strings
end

check:
  fun within(delta):
    lam(actual, target):
      num-abs(target - actual) &lt;= delta
    end
  end

  5.05 is%(within(0.1)) 5
  5.00002 is-not%(within(0.00001)) 5
end</p></pre></div></p></div><p class="boxed pyret-header"><span class="stt">expr1</span><span class="stt"> </span><a name="(part._testing_is~3d~3d)" class="pyret-code"></a><a href="#%28part._testing_is~3d~3d%29" data-pltdoc="x"><span class="stt">is==</span></a><span class="stt"> </span><span class="stt">expr2</span></p><p>Shorthand for <span class="pyret-highlight"><span class="stt">expr1</span></span> <a href="#%28part._testing_is~25%29" data-pltdoc="x"><span class="stt">is%</span></a><span class="pyret-highlight"><span class="stt">(</span></span><a href="equality.html#%28part._equality_equal-always%29" data-pltdoc="x"><span class="stt">equal-always</span></a><span class="pyret-highlight"><span class="stt">)</span></span> <span class="pyret-highlight"><span class="stt">expr1</span></span>.
Same as <a href="#%28part._testing_is%29" data-pltdoc="x"><span class="stt">is</span></a>.</p><p class="boxed pyret-header"><span class="stt">expr1</span><span class="stt"> </span><a name="(part._testing_is-not~3d~3d)" class="pyret-code"></a><a href="#%28part._testing_is-not~3d~3d%29" data-pltdoc="x"><span class="stt">is-not==</span></a><span class="stt"> </span><span class="stt">expr2</span></p><p>Like <a href="#%28part._testing_is~3d~3d%29" data-pltdoc="x"><span class="stt">is==</span></a>, but failure and success are reversed.
Same as <a href="#%28part._testing_is-not%29" data-pltdoc="x"><span class="stt">is-not</span></a>.</p><p class="boxed pyret-header"><span class="stt">expr1</span><span class="stt"> </span><a name="(part._testing_is~3d~7e)" class="pyret-code"></a><a href="#%28part._testing_is~3d~7e%29" data-pltdoc="x"><span class="stt">is=~</span></a><span class="stt"> </span><span class="stt">expr2</span></p><p>Shorthand for <span class="pyret-highlight"><span class="stt">expr1</span></span> <a href="#%28part._testing_is~25%29" data-pltdoc="x"><span class="stt">is%</span></a><span class="pyret-highlight"><span class="stt">(</span></span><a href="equality.html#%28part._equality_equal-now%29" data-pltdoc="x"><span class="stt">equal-now</span></a><span class="pyret-highlight"><span class="stt">)</span></span> <span class="pyret-highlight"><span class="stt">expr1</span></span></p><p class="boxed pyret-header"><span class="stt">expr1</span><span class="stt"> </span><a name="(part._testing_is-not~3d~7e)" class="pyret-code"></a><a href="#%28part._testing_is-not~3d~7e%29" data-pltdoc="x"><span class="stt">is-not=~</span></a><span class="stt"> </span><span class="stt">expr2</span></p><p>Like <a href="#%28part._testing_is~3d~7e%29" data-pltdoc="x"><span class="stt">is=~</span></a>, but failure and success are reversed.</p><p class="boxed pyret-header"><span class="stt">expr1</span><span class="stt"> </span><a name="(part._testing_is~3c~3d~3e)" class="pyret-code"></a><a href="#%28part._testing_is~3c~3d~3e%29" data-pltdoc="x"><span class="stt">is&lt;=&gt;</span></a><span class="stt"> </span><span class="stt">expr2</span></p><p>Shorthand for <span class="pyret-highlight"><span class="stt">expr1</span></span> <a href="#%28part._testing_is~25%29" data-pltdoc="x"><span class="stt">is%</span></a><span class="pyret-highlight"><span class="stt">(</span></span><a href="equality.html#%28part._equality_identical%29" data-pltdoc="x"><span class="stt">identical</span></a><span class="pyret-highlight"><span class="stt">)</span></span> <span class="pyret-highlight"><span class="stt">expr1</span></span></p><p class="boxed pyret-header"><span class="stt">expr1</span><span class="stt"> </span><a name="(part._testing_is-not~3c~3d~3e)" class="pyret-code"></a><a href="#%28part._testing_is-not~3c~3d~3e%29" data-pltdoc="x"><span class="stt">is-not&lt;=&gt;</span></a><span class="stt"> </span><span class="stt">expr2</span></p><p>Like <a href="#%28part._testing_is~3c~3d~3e%29" data-pltdoc="x"><span class="stt">is&lt;=&gt;</span></a>, but failure and success are reversed.</p><h5>2.2.2.2<tt>&nbsp;</tt><a name="(part._.Unary_.Test_.Operators)"></a>Unary Test Operators</h5><p class="boxed pyret-header"><span class="stt">expr</span><span class="stt"> </span><a name="(part._testing_satisfies)" class="pyret-code"></a><a href="#%28part._testing_satisfies%29" data-pltdoc="x"><span class="stt">satisfies</span></a><span class="stt"> </span><span class="stt">pred</span></p><p>Evaluates <span class="pyret-highlight"><span class="stt">expr</span></span> to a value and <span class="pyret-highlight"><span class="stt">pred</span></span> to a value expected to be a
function (if not a function, an error is thrown).  Then, <span class="pyret-highlight"><span class="stt">pred(val)</span></span> is
evaluated, and if the result is <span class="pyret-highlight"><span class="stt">true</span></span>, the test succeeds, and if
<span class="pyret-highlight"><span class="stt">false</span></span>, the test fails.</p><p class="boxed pyret-header"><span class="stt">expr</span><span class="stt"> </span><a name="(part._testing_violates)" class="pyret-code"></a><a href="#%28part._testing_violates%29" data-pltdoc="x"><span class="stt">violates</span></a><span class="stt"> </span><span class="stt">pred</span></p><p>Like <a href="#%28part._testing_satisfies%29" data-pltdoc="x"><span class="stt">satisfies</span></a>, but failure and success are reversed.</p><div class="examples"><p><div class="SIntrapara"><span style="font-weight: bold">Examples:</span></div><div class="SIntrapara"><pre class="pyret-highlight"><p>check:
  [list:] satisfies is-empty
  [list:] satisfies lam(l): l.length() == 0 end

  is-odd = lam(n :: Number): num-modulo(n, 2) == 1 end
  5 satisfies is-odd
  6 violates is-odd
end</p></pre></div></p></div><h5>2.2.2.3<tt>&nbsp;</tt><a name="(part._.Exception_.Test_.Operators)"></a>Exception Test Operators</h5><p class="boxed pyret-header"><span class="stt">expr</span><span class="stt"> </span><a name="(part._testing_raises)" class="pyret-code"></a><a href="#%28part._testing_raises%29" data-pltdoc="x"><span class="stt">raises</span></a><span class="stt"> </span><span class="stt">exn-string</span></p><p>Evaluates <span class="pyret-highlight"><span class="stt">expr</span></span> and expects an error to be raised.  If no error is
raised, the test fails.</p><p>If an error is the result, the <a href="_global_.html#%28part._~3cglobal~3e_torepr%29" data-pltdoc="x"><span class="stt">torepr</span></a> function is
called on the exception value, and <a href="#%28part._testing_raises%29" data-pltdoc="x"><span class="stt">raises</span></a> checks that
<span class="pyret-highlight"><span class="stt">exn-string</span></span> is contained within that string.  If so, the test passes,
otherwise, it fails.</p><p>For simple errors (like those in many programming assignments), it works to use
<a href="_global_.html#%28part._~3cglobal~3e_raise%29" data-pltdoc="x"><span class="stt">raise</span></a> on a string value and check that that string is
raised.  For larger programs, it can be useful to construct more sophisticated
error values and use <a href="#%28part._testing_raises-satisfies%29" data-pltdoc="x"><span class="stt">raises-satisfies</span></a> to test them.</p><div class="examples"><p><div class="SIntrapara"><span style="font-weight: bold">Examples:</span></div><div class="SIntrapara"><pre class="pyret-highlight"><p>check:
  raise("the roof!") raises "the roof"

  string-length("too", "many", "strings") raises "arity-mismatch"

  {}.x raises "field-not-found"
end</p></pre></div></p></div><p><span style="font-weight: bold">Warning!</span> These two tests are not equivalent:</p><pre class="pyret-highlight"><p>check "actually catches the error":
  raise("error!") raises "error!"
end

check "error happens before raises":
  value = raise("error!")
  value raises "error!"
end</p></pre><p>This is because the left-hand-side of <a href="#%28part._testing_raises%29" data-pltdoc="x"><span class="stt">raises</span></a> is a special position
that can detect and catch errors, which normal expressions do not do.  So the
second check block fails before even getting to the <a href="#%28part._testing_raises%29" data-pltdoc="x"><span class="stt">raises</span></a> line; try
it out and see what happens.</p><p class="boxed pyret-header"><span class="stt">expr</span><span class="stt"> </span><a name="(part._testing_raises-other-than)" class="pyret-code"></a><a href="#%28part._testing_raises-other-than%29" data-pltdoc="x"><span class="stt">raises-other-than</span></a><span class="stt"> </span><span class="stt">exn-string</span></p><p>Like <a href="#%28part._testing_raises%29" data-pltdoc="x"><span class="stt">raises</span></a>, but the result must <span style="font-style: italic">not</span> contain <span class="pyret-highlight"><span class="stt">exn-string</span></span>.</p><p class="boxed pyret-header"><span class="stt">expr</span><span class="stt"> </span><a name="(part._testing_does-not-raise)" class="pyret-code"></a><a href="#%28part._testing_does-not-raise%29" data-pltdoc="x"><span class="stt">does-not-raise</span></a></p><p>Evaluates <span class="pyret-highlight"><span class="stt">expr</span></span> and checks that no error is raised while evaluating
it.  The expression can evaluate to any value.</p><p class="boxed pyret-header"><span class="stt">expr</span><span class="stt"> </span><a name="(part._testing_raises-satisfies)" class="pyret-code"></a><a href="#%28part._testing_raises-satisfies%29" data-pltdoc="x"><span class="stt">raises-satisfies</span></a><span class="stt"> </span><span class="stt">pred</span></p><p>As the name suggests, this combines the idea of <a href="#%28part._testing_raises%29" data-pltdoc="x"><span class="stt">raises</span></a> with
<a href="#%28part._testing_satisfies%29" data-pltdoc="x"><span class="stt">satisfies</span></a> and calls <span class="pyret-highlight"><span class="stt">pred</span></span> on the exception that
<span class="pyret-highlight"><span class="stt">expr</span></span> raises (if any).  Still fails if no exception is raised.</p><div class="examples"><p><div class="SIntrapara"><span style="font-weight: bold">Examples:</span></div><div class="SIntrapara"><pre class="pyret-highlight"><p>import is-field-not-found from error
check:
  o = {}
  o.x raises-satisfies E.is-field-not-found
end</p></pre></div></p></div><p class="boxed pyret-header"><span class="stt">expr</span><span class="stt"> </span><a name="(part._testing_raises-violates)" class="pyret-code"></a><a href="#%28part._testing_raises-violates%29" data-pltdoc="x"><span class="stt">raises-violates</span></a><span class="stt"> </span><span class="stt">pred</span></p><p>Like <a href="#%28part._testing_raises-satisfies%29" data-pltdoc="x"><span class="stt">raises-satisfies</span></a>, but the predicate must return
<span class="pyret-highlight"><span class="stt">false</span></span>.  Still fails if no exception is raised.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="s_annotations.html" title="backward to &quot;2.1.7 Annotations&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Language_Concepts.html" title="up to &quot;2 Language Concepts&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="equality.html" title="forward to &quot;2.3 equality&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>